module UI.Main where

import Graphics.UI.GLUT
import UI.Bindings
import UI.Display
import Data.IORef

points :: [(GLfloat,GLfloat,GLfloat,GLfloat)]
points = [
        (-1.0,0.75,0,0),(-0.75,0.75,0,1),(-0.5,0.75,0,0),(-0.25,0.75,0,1),(0.0,0.75,0,0),(0.25,0.75,0,1),(0.5,0.75,0,0),(0.75,0.75,0,1),
        (-1.0,0.5,0,1),(-0.75,0.5,0,0),(-0.5,0.5,0,1),(-0.25,0.5,0,0),(0.0,0.5,0,1),(0.25,0.5,0,0),(0.5,0.5,0,1),(0.75,0.5,0,0),
        (-1.0,0.25,0,0),(-0.75,0.25,0,1),(-0.5,0.25,0,0),(-0.25,0.25,0,1),(0.0,0.25,0,0),(0.25,0.25,0,1),(0.5,0.25,0,0),(0.75,0.25,0,1),
        (-1.0,0.0,0,1),(-0.75,0.0,0,0),(-0.5,0.0,0,1),(-0.25,0.0,0,0),(0.0,0.0,0,1),(0.25,0.0,0,0),(0.5,0.0,0,1),(0.75,0.0,0,0),
        (-1.0,-0.25,0,0),(-0.75,-0.25,0,1),(-0.5,-0.25,0,0),(-0.25,-0.25,0,1),(0.0,-0.25,0,0),(0.25,-0.25,0,1),(0.5,-0.25,0,0),(0.75,-0.25,0,1),
        (-1.0,-0.5,0,1),(-0.75,-0.5,0,0),(-0.5,-0.5,0,1),(-0.25,-0.5,0,0),(0.0,-0.5,0,1),(0.25,-0.5,0,0),(0.5,-0.5,0,1),(0.75,-0.5,0,0),
        (-1.0,-0.75,0,0),(-0.75,-0.75,0,1),(-0.5,-0.75,0,0),(-0.25,-0.75,0,1),(0.0,-0.75,0,0),(0.25,-0.75,0,1),(0.5,-0.75,0,0),(0.75,-0.75,0,1),
        (-1.0,-1.0,0,1),(-0.75,-1.0,0,0),(-0.5,-1.0,0,1),(-0.25,-1.0,0,0),(0.0,-1.0,0,1),(0.25,-1.0,0,0),(0.5,-1.0,0,1),(0.75,-1.0,0,0)
        ]


renderUI :: IO ()
renderUI = do
  (_progName, _args) <- getArgsAndInitialize
  initialWindowSize $= Size 600 600
  _window <- createWindow "Chess"
  displayPoints <- newIORef points
  displayCallback $= display displayPoints
  reshapeCallback $= Just reshape
  keyboardMouseCallback $= Just (keyboardMouse displayPoints)
  mainLoop